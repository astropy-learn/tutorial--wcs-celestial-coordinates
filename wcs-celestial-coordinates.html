
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>WCS Celestial Coordinates</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=720ed60b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-ZBXC3EFGGJ"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-ZBXC3EFGGJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-ZBXC3EFGGJ');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'wcs-celestial-coordinates';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.svg" class="logo__image only-light" alt="None - Home"/>
    <script>document.write(`<img src="_static/logo.svg" class="logo__image only-dark" alt="None - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    Working with Celestial Coordinates in WCS 1: Specifying, reading, and plotting
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/astropy-learn/tutorial--wcs-celestial-coordinates" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/astropy-learn/tutorial--wcs-celestial-coordinates/issues/new?title=Issue%20on%20page%20%2Fwcs-celestial-coordinates.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working with Celestial Coordinates in WCS 1: Specifying, reading, and plotting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-celestial-coordinates-in-wcs-1-specifying-reading-and-plotting">
<h1>Working with Celestial Coordinates in WCS 1: Specifying, reading, and plotting<a class="headerlink" href="#working-with-celestial-coordinates-in-wcs-1-specifying-reading-and-plotting" title="Link to this heading">#</a></h1>
<section id="authors">
<h2>Authors<a class="headerlink" href="#authors" title="Link to this heading">#</a></h2>
<p>Kris Stern, Kelle Cruz, Lia Corrales, David Shupe, Adrian Price-Whelan</p>
</section>
<section id="learning-goals">
<h2>Learning Goals<a class="headerlink" href="#learning-goals" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Demonstrate two ways to build a <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object</p></li>
<li><p>Show an image of the Helix nebula with RA and Dec labeled</p></li>
<li><p>Plot a scale bar on an image with WCS information</p></li>
</ol>
</section>
<section id="keywords">
<h2>Keywords<a class="headerlink" href="#keywords" title="Link to this heading">#</a></h2>
<p>WCS, coordinates, matplotlib</p>
</section>
<section id="companion-content">
<h2>Companion Content<a class="headerlink" href="#companion-content" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>“An Introduction to Modern Astrophysics” (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2006ima..book.....C/abstract">Carroll &amp; Ostlie</a>)</p></li>
<li><p><a class="reference external" href="https://fits.gsfc.nasa.gov/fits_wcs.html">FITS WCS page at GSFC</a></p></li>
</ol>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>This tutorial series aims to show how the content of Chapter 1 of “An Introduction to Modern Astrophysics” by Carroll and Ostlie can be applied to real life astrophysics research situations, using tools in the Astropy ecosystem. We will introduce two different approaches to building a <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object, which contains meta-data that (in this case) defines a mapping between image coordinates and sky coordinates. The <code class="docutils literal notranslate"><span class="pre">astropy.wcs</span></code> subpackage conforms to the standards of the FITS World Coordinate System (WCS) used extensively by the astronomy research community. We will created a 2D WCS for an image of the iconic the Helix nebula (a planetary nebula) and display an image of the nebula with sky coordinates (here, equatorial, ICRS RA and Dec.) labeled. Finally, we will over-plot a scale bar on the Helix nebula image using WCS to give the reader a sense of the angular size of the image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">astropy.wcs</span><span class="w"> </span><span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">astropy.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">fits</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="section-1-two-ways-to-create-an-astropy-wcs-wcs-object">
<h2>Section 1: Two ways to create an <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object<a class="headerlink" href="#section-1-two-ways-to-create-an-astropy-wcs-wcs-object" title="Link to this heading">#</a></h2>
<p><em>World coordinates</em> serve to locate a measurement in some multi-dimensional parameter space. A World Coordinate System (WCS) specifies the physical, or world, coordinates to be attached to each pixel or voxel of an N-dimensional image or array. An <a class="reference external" href="https://fits.gsfc.nasa.gov/fits_wcs.html">elaborate set of standards and conventions</a> have been developed for the Flexible Image Transport System (FITS) format (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1981A&amp;amp;AS...44..363W/abstract">Wells et al. 1981</a>). A typical WCS example is to specify the Right Ascension (RA) and Declination (Dec) on the sky associated with a given the pixel or spaxel location in a 2-dimensional celestial image (<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A&amp;amp;A...395.1061G/abstract">Greisen &amp; Calabretta 2002</a>; <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A&amp;amp;A...395.1077C/abstract">Calabretta and Greisen 2002</a>).</p>
<p>The <a class="reference external" href="https://docs.astropy.org/en/stable/wcs/"><code class="docutils literal notranslate"><span class="pre">astropy.wcs</span></code> subpackage</a> implements FITS standards and conventions for World Coordinate Systems. Using the <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code>, we can generate images of the sky that have axes labeled with coordinates such as right ascension (RA) and declination (Dec). This requires selecting the proper projections for <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> and providing an <code class="docutils literal notranslate"><span class="pre">astropy.visualization.WCSAxes</span></code> object.</p>
<p>There are two main ways to initialize a <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object: with a Python dictionary (or dictionary-like object, like a FITS file header) or with Python lists. In this set of examples, we will initialize an <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object with two dimensions, as would be needed to represent an image.</p>
<p>The WCS standard defines a set of keywords that are used to represent the world coordinate system for a given set of data (e.g., image). Here is a list of the essential WCS keywords and their uses; In each case, the integer <span class="math notranslate nohighlight">\(n\)</span> denotes the dimensional axis (starting with 1) to which the keyword is being applied. In our examples below, we will have two image dimensions (axes), so <span class="math notranslate nohighlight">\(n\)</span> will either be 1 or 2.</p>
<ul class="simple">
<li><p><strong>CRVALn</strong>: the coordinate value at a reference point (e.g., RA and DEC value in degrees)</p></li>
<li><p><strong>CRPIXn</strong>: the pixel location of the reference point (e.g., CRPIX1=1, CRPIX2=1 describes the center of a corner pixel)</p></li>
<li><p><strong>CDELTn</strong>: the coordinate increment at the reference point (e.g., the difference in ‘RA’ value from the reference pixel to its neighbor along the RA axis)</p></li>
<li><p><strong>CTYPEn</strong>: an 8-character string describing the axis type (e.g., ‘RA—TAN’ and ‘DEC—TAN’ describe the typical tangent-plane sky projection that astronomers use)</p></li>
<li><p><strong>CUNITn</strong>: a string describing the unit for each axis (if not specified, the default unit is degrees.)</p></li>
<li><p><strong>NAXISn</strong>: an integer defining the number of pixels in each axis</p></li>
</ul>
<p>Some good references of the WCS standard can be found <a class="reference external" href="https://fits.gsfc.nasa.gov/fits_wcs.html">here</a>.</p>
<section id="method-1-building-a-wcs-object-with-a-dictionary">
<h3>Method 1: Building a WCS object with a dictionary<a class="headerlink" href="#method-1-building-a-wcs-object-with-a-dictionary" title="Link to this heading">#</a></h3>
<p>One way to define an Astropy <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object is to construct a dictionary containing all of the essential information (i.e., specifying values for the WCS keywords listed above) that map the pixel coordinate space to the world coordinate space.</p>
<p>In this example, we define two coordinate axes with:</p>
<ul class="simple">
<li><p>A Gnomonic (tangent-plane) projection, which corresponds to the RA/Dec coordinate system</p></li>
<li><p>A reference location of (RA,DEC) = (337.52, -20.83), as defined by the <strong>CRVALn</strong> keys</p></li>
<li><p>The pixel at coordinate value (1,1) as the reference location (<strong>CRPIXn</strong> keys)</p></li>
<li><p>Units of degrees (<strong>CUNITn = ‘deg’</strong>)</p></li>
<li><p>Pixel sizes of 1 x 1 arcsec (<strong>CDELTn = 0.002778</strong> in degrees)</p></li>
<li><p>An image size of 1024 x 1024 pixels (<strong>NAXISn</strong> key)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_input_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;CTYPE1&quot;</span><span class="p">:</span> <span class="s2">&quot;RA---TAN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CUNIT1&quot;</span><span class="p">:</span> <span class="s2">&quot;deg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDELT1&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.0002777777778</span><span class="p">,</span>
    <span class="s2">&quot;CRPIX1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;CRVAL1&quot;</span><span class="p">:</span> <span class="mf">337.5202808</span><span class="p">,</span>
    <span class="s2">&quot;NAXIS1&quot;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
    <span class="s2">&quot;CTYPE2&quot;</span><span class="p">:</span> <span class="s2">&quot;DEC--TAN&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CUNIT2&quot;</span><span class="p">:</span> <span class="s2">&quot;deg&quot;</span><span class="p">,</span>
    <span class="s2">&quot;CDELT2&quot;</span><span class="p">:</span> <span class="mf">0.0002777777778</span><span class="p">,</span>
    <span class="s2">&quot;CRPIX2&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;CRVAL2&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">20.833333059999998</span><span class="p">,</span>
    <span class="s2">&quot;NAXIS2&quot;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">wcs_helix_dict</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">wcs_input_dict</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s print the <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object defined with a Python dictionary to check its content:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix_dict</span>  <span class="c1"># To check output</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39; &#39;DEC--TAN&#39; 
CRVAL : 337.5202808 -20.833333059999998 
CRPIX : 1.0 1.0 
PC1_1 PC1_2  : 1.0 0.0 
PC2_1 PC2_2  : 0.0 1.0 
CDELT : -0.0002777777778 0.0002777777778 
NAXIS : 1024  1024
</pre></div>
</div>
</div>
</div>
<p>In this demonstration (and below), we assume that we know all of the relevant WCS keyword values to specify. Typically, however, we will rely on software to produce these values for us. For example, WCS information is most often included automatically in FITS files produced by software used to take images with most instruments at astronomical observatories. In cases when the WCS information is provided for us in a FITS file, it is typically included in a FITS header, which, when read into Python, acts like a dictionary object. We demonstrate this later on in this tutorial.</p>
</section>
<section id="method-2-create-an-empty-wcs-object-before-assigning-values">
<h3>Method 2: Create an empty WCS object before assigning values<a class="headerlink" href="#method-2-create-an-empty-wcs-object-before-assigning-values" title="Link to this heading">#</a></h3>
<p>Alternatively, we could initialize the <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object, and assign the keyword values with lists corresponding to each respective axis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix_list</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">naxis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">wcs_helix_list</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">crpix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">wcs_helix_list</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">crval</span> <span class="o">=</span> <span class="p">[</span><span class="mf">337.5202808</span><span class="p">,</span> <span class="o">-</span><span class="mf">20.833333059999998</span><span class="p">]</span>
<span class="n">wcs_helix_list</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">cunit</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;deg&quot;</span><span class="p">,</span> <span class="s2">&quot;deg&quot;</span><span class="p">]</span>
<span class="n">wcs_helix_list</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">ctype</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RA---TAN&quot;</span><span class="p">,</span> <span class="s2">&quot;DEC--TAN&quot;</span><span class="p">]</span>
<span class="n">wcs_helix_list</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">cdelt</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0002777777778</span><span class="p">,</span> <span class="mf">0.0002777777778</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s print the <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object one more time to check how our values were assigned.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix_list</span>  <span class="c1"># To check output</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39; &#39;DEC--TAN&#39; 
CRVAL : 337.5202808 -20.833333059999998 
CRPIX : 1.0 1.0 
PC1_1 PC1_2  : 1.0 0.0 
PC2_1 PC2_2  : 0.0 1.0 
CDELT : -0.0002777777778 0.0002777777778 
NAXIS : 0  0
</pre></div>
</div>
</div>
</div>
<p>Note that when we initialize the WCS object this way, the <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code> values are set to 0. To assign coordinates to our image, we will need to fix the shape of the <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object array so that it matches our image. We can do this by assigning a value to the <code class="docutils literal notranslate"><span class="pre">array_shape</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix_list</span><span class="o">.</span><span class="n">array_shape</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1024</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now when we print the <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object, we can see that the <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code> values have been updated from the default size of 0 to 1024.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39; &#39;DEC--TAN&#39; 
CRVAL : 337.5202808 -20.833333059999998 
CRPIX : 1.0 1.0 
PC1_1 PC1_2  : 1.0 0.0 
PC2_1 PC2_2  : 0.0 1.0 
CDELT : -0.0002777777778 0.0002777777778 
NAXIS : 1024  1024
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="section-2-show-an-image-of-the-helix-nebula-with-ra-and-dec-labeled">
<h2>Section 2: Show an image of the Helix nebula with RA and Dec labeled<a class="headerlink" href="#section-2-show-an-image-of-the-helix-nebula-with-ra-and-dec-labeled" title="Link to this heading">#</a></h2>
<p>Most of the time we can obtain the required <code class="docutils literal notranslate"><span class="pre">astropy.wcs.WCS</span></code> object from the header of the FITS file from a telescope or astronomical database. This process is described below.</p>
<section id="step-1-read-in-the-fits-file">
<h3>Step 1: Read in the FITS file<a class="headerlink" href="#step-1-read-in-the-fits-file" title="Link to this heading">#</a></h3>
<p>We will read the FITS file containing an image of the Helix nebula from the <code class="docutils literal notranslate"><span class="pre">astropy-data</span></code> GitHub repository using the <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> subpackage. The <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.open()</span></code> function will load the contents of a FITS file into Python, and it accepts either a local file path or a URL (as is demonstrated here). This image (FITS file) was originally accessed from the <a class="reference external" href="https://archive.eso.org/dss/dss">Digitized Sky Survey</a> but is provided in the <code class="docutils literal notranslate"><span class="pre">astropy-data</span></code> repository for convenience:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">header_data_unit_list</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
    <span class="s2">&quot;https://github.com/astropy/astropy-data/raw/6d92878d18e970ce6497b70a9253f65c925978bf/tutorials/celestial-coords1/tailored_dss.22.29.38.50-20.50.13_60arcmin.fits&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>FITS files are a binary file format that is mainly used by astronomers and can contain information arranged in many “extensions,” which contain both header information (e.g., metadata) and data (e.g., image data). We can check how many extensions there are in a FITS file, as well as view a summary of the contents in each extension, by printing the FITS object information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">header_data_unit_list</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Filename: /home/runner/.astropy/cache/download/url/21d072715b8ee90ab2fe1405b0e5fb1a/contents
No.    Name      Ver    Type      Cards   Dimensions   Format
  0  PRIMARY       1 PrimaryHDU     121   (2119, 2119)   int16   
</pre></div>
</div>
</div>
</div>
<p>This shows us that our FITS file contains only one extension, labeled ‘PRIMARY’ (or extension number 0). We will copy the image data from this extension to the variable <code class="docutils literal notranslate"><span class="pre">image</span></code>, and the header data to the variable <code class="docutils literal notranslate"><span class="pre">header</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">header_data_unit_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="n">header</span> <span class="o">=</span> <span class="n">header_data_unit_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
</pre></div>
</div>
</div>
</div>
<p>We can print the FITS image header to screen so that all of its contents can be checked or utilized. Note that the WCS information for this information can be found near the bottom of the printed header, below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">header</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SIMPLE  =                    T / conforms to FITS standard                      
BITPIX  =                   16 / array data type                                
NAXIS   =                    2 / number of array dimensions                     
NAXIS1  =                 2119                                                  
NAXIS2  =                 2119                                                  
DATE    = &#39;03/09/19          &#39; /Date of FITS file creation                      
ORIGIN  = &#39;CASB -- STScI     &#39; /Origin of FITS image                            
PLTLABEL= &#39;J 10265           &#39; /Observatory plate label                         
PLATEID = &#39;04I5              &#39; /GSSS Plate ID                                   
REGION  = &#39;S602              &#39; /GSSS Region Name                                
DATE-OBS= &#39;1985-06-15&#39;         / UT date of Observation                         
UT      = &#39;18:30:00.00       &#39; /UT time of observation                          
EPOCH   =  1.9854542236328E+03 /Epoch of plate                                  
PLTRAH  =                   22 /Plate center RA                                 
PLTRAM  =                   26 /                                                
PLTRAS  =  4.3474570000000E+01 /                                                
PLTDECSN= &#39;-                 &#39; /Plate center Dec                                
PLTDECD =                   19 /                                                
PLTDECM =                   44 /                                                
PLTDECS =  4.2059660000000E+01 /                                                
EQUINOX =  2.0000000000000E+03 /Julian Reference frame equinox                  
EXPOSURE=  7.0000000000000E+01 /Exposure time minutes                           
BANDPASS=                    0 /GSSS Bandpass code                              
PLTGRADE=                    1 /Plate grade                                     
PLTSCALE=  6.7200000000000E+01 /Plate Scale arcsec per mm                       
SITELAT = &#39;-31:16:24.00      &#39; /Latitude of Observatory                         
SITELONG= &#39;+149:03:42.00     &#39; /Longitude of Observatory                        
TELESCOP= &#39;UK Schmidt (new optics)&#39; /Telescope where plate taken                
CNPIX1  =                 4541 /X corner  (pixels)                              
CNPIX2  =                 3647 /Y corner                                        
DATATYPE= &#39;INTEGER*2         &#39; /Type of Data                                    
SCANIMG = &#39;S602_04I5_00_00.PIM&#39; /Name of original scan                          
SCANNUM =                    0 /Identifies scan of the plate                    
DCHOPPED=                    F /Image repaired for chopping effects             
DSHEARED=                    F /Image repaired for shearing effects             
DSCNDNUM=                    0 /Identifies descendant of plate scan image       
XPIXELSZ=  2.5284450000000E+01 /X pixel size microns                            
YPIXELSZ=  2.5284450000000E+01 /Y pixel size microns                            
PPO1    =  0.0000000000000E+00 /Orientation Coefficients                        
PPO2    =  0.0000000000000E+00 /                                                
PPO3    =  1.7800815369865E+05 /                                                
PPO4    =  0.0000000000000E+00 /                                                
PPO5    =  0.0000000000000E+00 /                                                
PPO6    =  1.7762863283887E+05 /                                                
AMDX1   =  6.7219770175765E+01 /Plate solution x coefficients                   
AMDX2   = -1.1880355995672E-01 /                                                
AMDX3   = -1.3157645513770E-01 /                                                
AMDX4   = -5.6708509711628E-06 /                                                
AMDX5   =  6.2679885786864E-06 /                                                
AMDX6   = -1.1142206237378E-07 /                                                
AMDX7   =  0.0000000000000E+00 /                                                
AMDX8   =  2.2200418019794E-06 /                                                
AMDX9   =  7.4390602168984E-10 /                                                
AMDX10  =  2.5668005274713E-06 /                                                
AMDX11  = -2.6549905009760E-07 /                                                
AMDX12  =  0.0000000000000E+00 /                                                
AMDX13  =  0.0000000000000E+00 /                                                
AMDX14  =  0.0000000000000E+00 /                                                
AMDX15  =  0.0000000000000E+00 /                                                
AMDX16  =  0.0000000000000E+00 /                                                
AMDX17  =  0.0000000000000E+00 /                                                
AMDX18  =  0.0000000000000E+00 /                                                
AMDX19  =  0.0000000000000E+00 /                                                
AMDX20  =  0.0000000000000E+00 /                                                
AMDY1   =  6.7228009015427E+01 /Plate solution y coefficients                   
AMDY2   =  1.2873652788750E-01 /                                                
AMDY3   = -3.1950040128023E-01 /                                                
AMDY4   = -3.2645385511415E-05 /                                                
AMDY5   =  8.7305582924401E-06 /                                                
AMDY6   =  1.8171663502226E-05 /                                                
AMDY7   =  0.0000000000000E+00 /                                                
AMDY8   =  2.1698493473859E-06 /                                                
AMDY9   = -3.6671971341692E-08 /                                                
AMDY10  =  2.4125963913336E-06 /                                                
AMDY11  = -1.9511911767187E-08 /                                                
AMDY12  =  0.0000000000000E+00 /                                                
AMDY13  =  0.0000000000000E+00 /                                                
AMDY14  =  0.0000000000000E+00 /                                                
AMDY15  =  0.0000000000000E+00 /                                                
AMDY16  =  0.0000000000000E+00 /                                                
AMDY17  =  0.0000000000000E+00 /                                                
AMDY18  =  0.0000000000000E+00 /                                                
AMDY19  =  0.0000000000000E+00 /                                                
AMDY20  =  0.0000000000000E+00 /                                                
        Based on photographic data obtained using The UK Schmidt Telescope.     
        The UK Schmidt Telescope was operated by the Royal Observatory          
        Edinburgh, with funding from the UK Science and Engineering Research    
        Council, until 1988 June, and thereafter by the Anglo-Australian        
        Observatory.  Original plate material is copyright (c) the Royal        
        Observatory Edinburgh and the Anglo-Australian Observatory.  The        
        plates were processed into the present compressed digital form with     
        their permission.  The Digitized Sky Survey was produced at the Space   
        Telescope Science Institute under US Government grant NAG W-2166.       
                                                                                
        Investigators using these scans are requested to include the above      
        acknowledgements in any publications.                                   
                                                                                
        Copyright (c) 1993, 1994, Association of Universities for Research in   
        Astronomy, Inc.  All rights reserved.                                   
DATAMAX =                21635 /Maximum data value                              
DATAMIN =                  607 /Minimum data value                              
OBJECT  = &#39;dss67608          &#39; /Object ID                                       
OBJCTRA = &#39;22 29 38.500      &#39; /Object Right Ascension (J2000)                  
OBJCTDEC= &#39;-20 50 13.00      &#39; /Object Declination (J2000)                      
OBJCTX  =              5600.52 /Object X on plate (pixels)                      
OBJCTY  =              4706.97 /Object Y on plate (pixels)                      
CTYPE1  = &#39;RA---TAN&#39;           /R.A. in tangent plane projection                
CTYPE2  = &#39;DEC--TAN&#39;           /DEC. in tangent plane projection                
CRPIX1  =               1059.5 /Refpix of first axis                            
CRPIX2  =               1059.5 /Refpix of second axis                           
CRVAL1  =  3.3741068406866E+02 /RA at Ref pix in decimal degrees                
CRVAL2  = -2.0837400617286E+01 /DEC at Ref pix in decimal degrees               
CROTA1  =  3.6014388955457E-01 /Rotation angle of first axis (deg)              
CROTA2  =  3.6014388955457E-01 /Rotation angle of second axis (deg)             
        Warning: CROTA2 is inaccurate due to considerable skew                  
CDELT1  = -4.7215565578926E-04 /RA pixel step (deg)                             
CDELT2  =  4.7224980649186E-04 /DEC pixel step (deg)                            
CD1_1   = -4.7214664002041E-04 /CD matrix                                       
CD1_2   = -3.0184077818787E-06 /CD matrix                                       
CD2_1   = -2.9178093186884E-06 /CD matrix                                       
CD2_2   =  4.7224016024271E-04 /CD matrix                                       
</pre></div>
</div>
</div>
</div>
<p>Please note that the <em>original</em> header (as downloaded from the DSS) violates the FITS WCS standards (because it includes both CDELTn keywords and a matrix of CD values; including deprecated PC-matrix keywords). The header has been cleaned up to conform to the existing standards.</p>
</section>
<section id="step-2-read-in-the-fits-image-coordinate-system-with-astropy-wcs-wcs">
<h3>Step 2: Read in the FITS image coordinate system with astropy.wcs.WCS<a class="headerlink" href="#step-2-read-in-the-fits-image-coordinate-system-with-astropy-wcs-wcs" title="Link to this heading">#</a></h3>
<p>Because the header contains WCS information and acts like a Python dictionary, an Astropy <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object can be created directly from the FITS header.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: FITSFixedWarning: &#39;datfix&#39; made the change &#39;Set MJD-OBS to 46231.000000 from DATE-OBS&#39;. [astropy.wcs.wcs]
</pre></div>
</div>
</div>
</div>
<p>Let’s print the <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object to see what values were drawn from the header.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wcs_helix</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WCS Keywords

Number of WCS axes: 2
CTYPE : &#39;RA---TAN&#39; &#39;DEC--TAN&#39; 
CRVAL : 336.6811440416667 -19.745016572222223 
CRPIX : 2499.6447489941065 3378.9002584168584 
PC1_1 PC1_2  : 0.025282857855146917 4.4684674035885186e-05 
PC2_1 PC2_2  : -4.8420685266167345e-05 0.0252859566668733 
CDELT : -0.01867333422948538 0.01867333422948538 
NAXIS : 2119  2119
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-plot-the-helix-nebula-with-sky-coordinate-axes-ra-and-dec">
<h3>Step 3: Plot the Helix nebula with sky coordinate axes (RA and Dec)<a class="headerlink" href="#step-3-plot-the-helix-nebula-with-sky-coordinate-axes-ra-and-dec" title="Link to this heading">#</a></h3>
<p>The image data, <code class="docutils literal notranslate"><span class="pre">image</span></code>, is a 2D array of values, and by itself contains no information about the sky coordinates of the pixels. So, if we plotted the image by itself, the plot axes would show pixel values. (We will be using the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library for the plotting.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7ff9caf13200&gt;
</pre></div>
</div>
<img alt="_images/da5346b9c808387802c8d350906cada585964ca3a7f3da64f54aca2420b56e3d.png" src="_images/da5346b9c808387802c8d350906cada585964ca3a7f3da64f54aca2420b56e3d.png" />
</div>
</div>
<p>All of the information that maps from these pixel values to sky coordinates comes from the WCS metadata, which we loaded into the <code class="docutils literal notranslate"><span class="pre">wcs_helix</span></code> object (from the FITS file header). This <code class="docutils literal notranslate"><span class="pre">WCS</span></code> object is built so that it can be provided to <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> with the  <code class="docutils literal notranslate"><span class="pre">projection</span></code> keyword, as shown in the call to <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.subplot</span></code> below, in order to produce axes that show sky coordinate information instead of pixel values. We will also overlay a coordinate grid in ICRS equatorial coordinates by passing the sky coordinate frame name (here, “icrs”) to the <code class="docutils literal notranslate"><span class="pre">ax.get_coords_overlay()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs_helix</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;RA&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Dec&quot;</span><span class="p">)</span>

<span class="n">overlay</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_coords_overlay</span><span class="p">(</span><span class="s2">&quot;icrs&quot;</span><span class="p">)</span>
<span class="n">overlay</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1731588eb07b0322a0d118a111da6c59399f102e350941893e31ac00b3b81134.png" src="_images/1731588eb07b0322a0d118a111da6c59399f102e350941893e31ac00b3b81134.png" />
</div>
</div>
</section>
</section>
<section id="exercise">
<h2>Exercise<a class="headerlink" href="#exercise" title="Link to this heading">#</a></h2>
<p>Copy the code block above and instead overlay a coordinate grid in Galactic coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs_helix</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;RA&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Dec&quot;</span><span class="p">)</span>

<span class="n">overlay</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_coords_overlay</span><span class="p">(</span><span class="s2">&quot;galactic&quot;</span><span class="p">)</span>
<span class="n">overlay</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;dotted&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/1027f1e24b70c94693fb609bf566e59aaeeb455bc2b07a349f5e72dfd334c1ec.png" src="_images/1027f1e24b70c94693fb609bf566e59aaeeb455bc2b07a349f5e72dfd334c1ec.png" />
</div>
</div>
</section>
<section id="section-3-plot-a-scale-marker-on-an-image-with-wcs">
<h2>Section 3: Plot a scale marker on an image with WCS<a class="headerlink" href="#section-3-plot-a-scale-marker-on-an-image-with-wcs" title="Link to this heading">#</a></h2>
<p>To add a scale marker (i.e., a line of a particular <em>angular</em> size) to the image of the Helix nebula, we will use the matplotlib <code class="docutils literal notranslate"><span class="pre">Axes.arrow</span></code> method to draw a line.</p>
<p>First, we need to decide where to place the scale bar. In the example below, we define the center of the scale marker to be at <code class="docutils literal notranslate"><span class="pre">(RA,</span> <span class="pre">Dec)</span> <span class="pre">=</span> <span class="pre">(337</span> <span class="pre">deg,</span> <span class="pre">-21.2</span> <span class="pre">deg)</span></code>.</p>
<p>We then use the <code class="docutils literal notranslate"><span class="pre">transform</span></code> attribute of <code class="docutils literal notranslate"><span class="pre">Axes.arrow</span></code> to draw our scale bars in degrees (instead of pixel coordinates). In this case, we draw a scale marker with a length of 0.1 degrees. The arrow method inputs are <code class="docutils literal notranslate"><span class="pre">ax.arrow(x,</span> <span class="pre">y,</span> <span class="pre">dx,</span> <span class="pre">dy,</span> <span class="pre">**kwargs)</span></code>, with <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> being the <code class="docutils literal notranslate"><span class="pre">RA</span></code> and <code class="docutils literal notranslate"><span class="pre">Dec</span></code> of the beginning of the line. We use <code class="docutils literal notranslate"><span class="pre">dx=0</span></code> so that there is no horizontal component in the bar, and <code class="docutils literal notranslate"><span class="pre">dy=0.1</span></code>, which gives the length of the arrow in the vertical direction. To ensure that the arrow is drawn in the J2000 ICRS coordinate frame, we pass <code class="docutils literal notranslate"><span class="pre">ax.get_transform('icrs')</span></code> to the <code class="docutils literal notranslate"><span class="pre">transform</span></code> keyword.</p>
<p>Finally, we use <code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot.text</span></code> to mark the length of the scale marker.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs_helix</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span>
    <span class="mi">337</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">21.2</span><span class="p">,</span>
    <span class="mi">0</span><span class="p">,</span>
    <span class="mf">0.1</span><span class="p">,</span>
    <span class="n">head_width</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">head_length</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">fc</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">ec</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mf">0.003</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s2">&quot;icrs&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span>
    <span class="mf">337.05</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">21.18</span><span class="p">,</span>
    <span class="s2">&quot;0.1 deg&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span>
    <span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span>
    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s2">&quot;icrs&quot;</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;cividis&quot;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;RA&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Dec&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d35948ac284ade4062f1ec0a8ae9c78c5b23eb82e146f87b0f41738fbf0a6a0e.png" src="_images/d35948ac284ade4062f1ec0a8ae9c78c5b23eb82e146f87b0f41738fbf0a6a0e.png" />
</div>
</div>
</section>
<section id="id1">
<h2>Exercise<a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Make a horizontal bar with the same length. Keep in mind that 1 hour angle = 15 degrees.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "astropy-learn/tutorial--wcs-celestial-coordinates",
            ref: "main/",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By AUTHOR1 (@GITHUB-USERNAME, ORCID-ID), AUTHOR2 (@GITHUB-USERNAME, ORCID-ID)
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>